(()=>{function e(e){return"string"!=typeof e?e:e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}document.addEventListener("DOMContentLoaded",(function(){var t=document.querySelectorAll(".wp-block-techplay-gutenberg-blocks-ai-image-gallery");t.length>0&&t.forEach((function(t){t.classList.contains("has-masonry-layout")&&void 0!==window.imagesLoaded&&void 0!==window.Masonry&&window.imagesLoaded(t).on("done",(function(){new window.Masonry(t,{itemSelector:".gallery-item",percentPosition:!0,gutter:parseInt(window.getComputedStyle(t).getPropertyValue("--gap"))||0})})),t.classList.contains("has-lightbox")&&function(e){if(e.classList.contains("has-lightbox")){var t=document.getElementById("ai-gallery-lightbox-modal");t||((t=document.createElement("div")).id="ai-gallery-lightbox-modal",t.innerHTML='\n            <div class="modal-content">\n                <figure>\n                    <img src="" alt="" id="lightbox-image">\n                </figure>\n                <button class="close-button" title="Close lightbox">\n                     <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" width="18" height="18">\n                        <path d="M6.28 5.22a.75.75 0 0 0-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 1 0 1.06 1.06L10 11.06l3.72 3.72a.75.75 0 1 0 1.06-1.06L11.06 10l3.72-3.72a.75.75 0 0 0-1.06-1.06L10 8.94 6.28 5.22Z" />\n                     </svg>\n                </button>\n            </div>\n        ',t.querySelector(".close-button").addEventListener("mousedown",(function(e){e.stopPropagation(),t.style.display="none"})),t.addEventListener("mousedown",(function(e){e.target===t&&(t.style.display="none")})),document.body.appendChild(t));var i=t.querySelector("#lightbox-image");e.querySelectorAll(".gallery-item img").forEach((function(e){e.style.cursor="pointer",e.addEventListener("click",(function(e){if(!e.target.closest("button")){var a=e.target.dataset.largeSrc||e.target.src,o=e.target.alt||"";i.src=a,i.alt=o,t.style.display="flex"}}))}))}}(t),t.querySelectorAll(".gallery-item").forEach((function(t){var i=t.querySelector(".image-info-icon"),a=t.querySelector(".copy-url-button"),o=t.querySelector(".download-image-button"),n=t.querySelector("img");i&&i.addEventListener("click",(function(t){t.stopPropagation(),function(t,i){var a=jQuery("#ai-gallery-info-modal");0===a.length&&(jQuery("body").append('\n            <div id="ai-gallery-info-modal" class="ai-image-modal" style="display: none;">\n                <div class="modal-content">\n                    <button class="close-button" title="Close">&times;</button>\n                    <div class="image-meta"></div>\n                </div>\n            </div>\n        '),(a=jQuery("#ai-gallery-info-modal")).on("click",(function(e){(jQuery(e.target).is(a)||jQuery(e.target).closest(".close-button").length)&&a.fadeOut(300)})));var o=a.find(".image-meta"),n="<h3>Image Generation Details</h3>",s=function(e,t){var i={positive:t||"",negative:"",params:{}};if(!e||"string"!=typeof e)return i;for(var a=e.split("\n"),o=-1,n=-1,s=0;s<a.length;s++)if(a[s].startsWith("Negative prompt:"))o=s;else if(a[s].startsWith("Steps:")){n=s;break}if(-1!==o?i.positive=a.slice(0,o).join("\n").trim():-1!==n?i.positive=a.slice(0,n).join("\n").trim():i.positive||(i.positive=e.trim()),-1!==o){var r=-1!==n&&n>o?n:a.length;i.negative=a.slice(o,r).join("\n").substring(16).trim()}if(-1!==n)for(var c,l=a.slice(n).join(", "),d=/(\w+(?:\s+\w+)*?):\s*("[^"\\]*(?:\\.[^"\\]*)*"|[^,]+(?:,\s*(?![A-Za-z\s]+:))?)/g;null!==(c=d.exec(l));){var g=c[1].trim(),m=c[2].trim();m.endsWith(",")&&(m=m.slice(0,-1).trim()),m.startsWith('"')&&m.endsWith('"')&&(m=m.slice(1,-1)),g&&(i.params[g]=m)}return i}(t,i);s.positive&&(n+='<div class="meta-section"><h4>Positive Prompt</h4><div class="prompt-box positive"><p>'.concat(e(s.positive),"</p></div></div>")),s.negative&&(n+='<div class="meta-section"><h4>Negative Prompt</h4><div class="prompt-box negative"><p>'.concat(e(s.negative),"</p></div></div>"));var r=Object.keys(s.params);if(r.length>0?(n+='<div class="meta-section generation-details-section"><h4>Parameters</h4>',r.forEach((function(t){n+="<p><strong>".concat(e(t),":</strong> <span>").concat(e(s.params[t]),"</span></p>")})),n+="</div>"):s.positive||s.negative||(n+='<div class="meta-section generation-details-section"><h4>Parameters</h4><p>No specific parameters found.</p></div>'),s.params["Civitai resources"]&&"string"==typeof s.params["Civitai resources"])try{var c=JSON.parse(s.params["Civitai resources"].replace(/&quot;/g,'"'));Array.isArray(c)&&(n+='<div class="meta-section civitai-resources-section"><h4>Civitai Resources</h4>',c.forEach((function(t){n+="<p><strong>Type:</strong> ".concat(e(t.type||"N/A"),", "),t.modelName&&t.modelVersionName?n+="<strong>Name:</strong> ".concat(e(t.modelName)," (").concat(e(t.modelVersionName),"), "):t.modelName&&(n+="<strong>Name:</strong> ".concat(e(t.modelName),", ")),void 0!==t.weight&&(n+="<strong>Weight:</strong> ".concat(e(t.weight))),n+="</p>"})),n+="</div>")}catch(t){n+='<div class="meta-section civitai-resources-section"><h4>Civitai Resources (Raw)</h4><pre>'.concat(e(s.params["Civitai resources"]),"</pre></div>")}o.html(n),a.css("display","flex").hide().fadeIn(300)}(n.dataset.parameters,n.dataset.prompt)})),a&&n&&a.addEventListener("click",(function(e){e.stopPropagation();var t=n.dataset.largeSrc||n.src;navigator.clipboard.writeText(t).then((function(){a.classList.add("copied"),setTimeout((function(){return a.classList.remove("copied")}),1500)})).catch((function(e){}))})),o&&n&&o.addEventListener("click",(function(e){e.stopPropagation();var t=n.dataset.largeSrc||n.src,i=document.createElement("a");i.href=t;var a=t.substring(t.lastIndexOf("/")+1).split("?")[0]||"download.jpg";i.download=a,document.body.appendChild(i),i.click(),document.body.removeChild(i)}))}))})),document.querySelectorAll(".ai-gallery-modal .close").forEach((function(e){e.addEventListener("click",(function(){var e=this.closest(".ai-gallery-modal");e&&(e.style.display="none")}))}))}))})();
//# sourceMappingURL=ai-image-gallery-frontend.js.map