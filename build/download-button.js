jQuery(document).ready((function(e){e(".download-button").on("click",(function(o){o.preventDefault();var n=e(this),a=n.data("file"),t=n.data("filename");"pdf"===a.split(".").pop().toLowerCase()?window.open(a,"_blank"):e.ajax({url:techplayBlocks.ajaxUrl,type:"POST",data:{action:"secure_download",nonce:techplayBlocks.nonce,file_url:a},xhrFields:{responseType:"blob"},success:function(e){var o=new Blob([e],{type:e.type}),n=window.URL.createObjectURL(o),c=document.createElement("a");c.href=n,c.download=t||a.split("/").pop(),document.body.appendChild(c),c.click(),document.body.removeChild(c),window.URL.revokeObjectURL(n)}}),e.ajax({url:techplayBlocks.ajaxUrl,type:"POST",data:{action:"increment_download_count",nonce:techplayBlocks.nonce,file_url:a}})}))}));